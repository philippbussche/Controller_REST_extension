allprojects {
    apply plugin: 'idea'

    group = 'com.appdynamics.ace.rest'
    version = '1.0'

    idea{
	    module {
        	excludeDirs += file('gradle')
        	excludeDirs += file('.idea')
        	//excludeDirs.remove(file("build"))
    	}
	}

    repositories {
    mavenCentral()
    maven {
        url "https://raw.github.com/Appdynamics/artifact-library/master/repo/"
        }
    }
}

configurations {
    release
}

dependencies {
    release project (':rest_util')
    release project (':rest_api')
    release project (':rest_server')
}



task packageServer(type: Zip) {
    from configurations.release

    include 'ace_*.jar'
    // Replace with better configuration Handling (MayBe)

    destinationDir = file("$buildDir/zips")
    baseName ='ACE_RestServer'
    extension = 'zip'
    version = '1.0'
}

task wrapper(type: Wrapper) {
    gradleVersion = '1.8'
}

task clean << {
    delete('build')
}

task build (dependsOn: packageServer) << {}


// Server Code Publish
apply plugin: 'maven-publish'

publishing {
    publications {
        mavenJava (MavenPublication) {
            artifactId 'rest_server'

            artifact packageServer {
                extension "zip"
            }
        }
    }
    repositories {
        maven {

            url "file:////vlab/maven/artifact-library/repo"
        }
    }
}




